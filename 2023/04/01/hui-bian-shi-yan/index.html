<!DOCTYPE html>
<html lang="en">
  <head>
    

    
<script>!function(){var e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=localStorage.getItem("use-color-scheme")||"auto";("dark"===t||e&&"light"!==t)&&document.documentElement.classList.toggle("dark",!0)}()</script>
    

<meta charset="utf-8" >

<title>8086汇编 实验 10</title>
<meta name="keywords" content="8086汇编 实验 10, 皮豪与你同在">
<meta name="description" content="显示字符串1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="8086汇编 实验 10">
<meta property="og:description" content="显示字符串1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162">

<link rel="shortcut icon" href="/favicon.ico">
<link rel="stylesheet" href="/style/main.css">

  <link rel="stylesheet" href="/style/simple-lightbox.min.css"><meta name="generator" content="Hexo 7.3.0"></head>
  <body>
    <div id="app" class="main">

<div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://pphboy.github.io">
        <img class="avatar" src="/images/avatar.png" alt="logo" width="32px" height="32px">
      </a>
      <a href="https://pphboy.github.io">
        <h1 class="site-title">皮豪与你同在</h1>
      </a>
    </div>
    <div class="right">
        <i class="icon menu-switch icon-menu-outline" ></i>
    </div>
  </div>
</div>

<div class="menu-container" style="height: 0;opacity: 0;">
<nav class="menu-list">
  
    
      <a href="/" class="menu purple-link">
        首页
      </a>
    
  
    
      <a href="/tags" class="menu purple-link">
        标签
      </a>
    
  
    
      <a href="/archives" class="menu purple-link">
        归档
      </a>
    
  
    
      <a href="/about" class="menu purple-link">
        关于
      </a>
    
  
</nav>
</div>



  <div class="content-container">
    <div class="post-detail">
      
      <h2 class="post-title">8086汇编 实验 10</h2>
      <div class="post-info post-detail-info">
        <span><i class="icon icon-calendar-outline"></i> 2023-04-01</span>
        
      </div>
      <div class="post-content-wrapper">
        <div class="post-content">
          <h3 id="显示字符串"><a href="#显示字符串" class="headerlink" title="显示字符串"></a>显示字符串</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code,ds:data,ss:stack</span><br><span class="line"></span><br><span class="line">data segment</span><br><span class="line">	db &#x27;Welcome to masm!&#x27;,0</span><br><span class="line">data ends</span><br><span class="line"></span><br><span class="line">stack segment</span><br><span class="line">	dd 16 dup(0)</span><br><span class="line">stack ends</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">	mov ax,0B800H</span><br><span class="line">	mov es,ax</span><br><span class="line">	mov ax,data</span><br><span class="line">	mov ds,ax</span><br><span class="line">	mov ax,stack</span><br><span class="line">	mov ss,ax</span><br><span class="line">	mov sp,32 ;; 初始化段址寄存器</span><br><span class="line">	</span><br><span class="line">	mov dh,10 ;; 行号</span><br><span class="line">	mov dl,0 ;; 列号</span><br><span class="line">	mov ch,0</span><br><span class="line">	mov cl,11000010B ;;颜色 </span><br><span class="line"></span><br><span class="line">	call show_str</span><br><span class="line"></span><br><span class="line">	mov ax,4c00h</span><br><span class="line">	int 21h</span><br><span class="line"></span><br><span class="line">show_str:</span><br><span class="line">	mov ax,0</span><br><span class="line">	mov al,160 ;; 每段的字符数量</span><br><span class="line">	mul dh ;; 字符数 乘以 行号</span><br><span class="line"></span><br><span class="line">	mov dh,0 ;; 00[dl] == 00A0H</span><br><span class="line">	add ax,dl ;; 每行起始为 0 ，+dl 就是 列的偏移</span><br><span class="line"></span><br><span class="line">	mov si,ax ;; 每行字符不超过160，总共是25行，所以用 16位乘法刚好</span><br><span class="line">	mov di,0 ;; 初始化 ds的偏移地址寄存器</span><br><span class="line">	</span><br><span class="line">	mov dl,cl ;; 保存cx 到 dx中，也就是存放的 cl 数据</span><br><span class="line"></span><br><span class="line">	s:</span><br><span class="line">		mov ch,0</span><br><span class="line">		mov cl,[di]</span><br><span class="line">		jcxz out  ;; 如果 cl 为 0 ，则是已到最后 一个 字符，跳出循环</span><br><span class="line">		;; 判断完后，恢复cx</span><br><span class="line"></span><br><span class="line">		mov byte ptr es:[si],cl;; 这个cl是 字符的信息</span><br><span class="line">		mov byte ptr es:[si+1],dl</span><br><span class="line"></span><br><span class="line">		inc di</span><br><span class="line">		add si,2</span><br><span class="line"></span><br><span class="line">		loop s</span><br><span class="line">	out:</span><br><span class="line">		mov byte ptr es:[si],&#x27;0&#x27;</span><br><span class="line">		mov byte ptr es:[si+1],11000010B</span><br><span class="line">		ret</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line"></span><br><span class="line">end start</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><a class="simple-lightbox" target="_blank" rel="noopener" href="https://img2023.cnblogs.com/blog/2146100/202304/2146100-20230401192726426-723514903.gif"><img   src="/images/loading.svg" data-src="https://img2023.cnblogs.com/blog/2146100/202304/2146100-20230401192726426-723514903.gif"  alt="imag1e" lazyload></a></p>
<h3 id="解决除法溢出"><a href="#解决除法溢出" class="headerlink" title="解决除法溢出"></a>解决除法溢出</h3><p>下面是思路，要先看题目再看思路</p>
<p>第一版的时候，只能 支持0FFFFFFF内的数字进行修改</p>
<p>主要难以计算高位的除法的存储问题。</p>
<p>FFFF0000是除不了的，只能拿到FFFF来除</p>
<p>结果是<br>FFFF0000 的结果 是不是等于 （FFF0&#x2F;CX + (F0&#x2F;CX)&#x2F;10H）* 1000H</p>
<p>所以这里有就有思路了，而且还能保留精度，就是把最后一位的数乘10，会得到一个准确值，你把这个值除10H，还会得到余数。</p>
<p>(F0&#x2F;CX)  ,AX &#x3D; 商， DX&#x3D;余数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">高位 = (FFF0/CX + (F0/CX)/10H )</span><br><span class="line">低位 = 余数*1000H + (FFFF/CX)</span><br><span class="line"></span><br><span class="line"> (FFFF/CX)，AX=商，DX=余数</span><br><span class="line"></span><br><span class="line"> 低位 = 余数*1000H + AX</span><br><span class="line"></span><br><span class="line"> CX = DX ; CX里放的就是余数</span><br><span class="line"> </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code,ds:data,ss:stack</span><br><span class="line"></span><br><span class="line">data segment</span><br><span class="line">	dd 16 dup(0)</span><br><span class="line">data ends</span><br><span class="line"></span><br><span class="line">stack segment</span><br><span class="line">	dd 16 dup(0)</span><br><span class="line">stack ends</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line">start:</span><br><span class="line">	mov ax,stack</span><br><span class="line">	mov ss,ax</span><br><span class="line">	mov ax,data</span><br><span class="line">	mov ds,ax</span><br><span class="line">	</span><br><span class="line">	;; 只能算 0FFFFFFF 内的除法</span><br><span class="line">	mov ax,4243H</span><br><span class="line">	mov dx,0FFFFH</span><br><span class="line">	mov cx,000AH</span><br><span class="line">	mov sp,3</span><br><span class="line">	</span><br><span class="line">	call divdw</span><br><span class="line"></span><br><span class="line">	mov ax,4c00h</span><br><span class="line">	int 21h</span><br><span class="line"></span><br><span class="line">;; 返回 ax = 低16位</span><br><span class="line">;; dx = 高16位</span><br><span class="line">;; cx = 余数</span><br><span class="line">divdw:</span><br><span class="line">	push ax</span><br><span class="line">	call divhigh</span><br><span class="line"></span><br><span class="line">	mov di,0</span><br><span class="line">	mov word ptr [di],ax ;; 高位商 保留值</span><br><span class="line">	mov word ptr [di].2,dx ;; 低位商</span><br><span class="line"></span><br><span class="line">	pop ax</span><br><span class="line"></span><br><span class="line">	;; 计算 ax 除 cx</span><br><span class="line">	mov dx,0</span><br><span class="line">	div cx</span><br><span class="line">	;; 余数在 dx中，商在 ax中 </span><br><span class="line">	mov cx,dx ;; 余数放到 cx里</span><br><span class="line">	mov dx,[di] ;; 高位商 移到 dx中</span><br><span class="line">	add ax,[di].2 ;; 低位商加到 ax中</span><br><span class="line">	</span><br><span class="line">	ret</span><br><span class="line"></span><br><span class="line">;; ax 为 原本的值</span><br><span class="line">;; cx 为 除数</span><br><span class="line">;; 返回值 (AX)+(DX)</span><br><span class="line">divhigh:</span><br><span class="line">	mov bx,dx</span><br><span class="line">	mov ax,bx</span><br><span class="line">	and bx,0000FH ;; 拿到个位数</span><br><span class="line">	and ax,0FFF0H ;; 去除个位数</span><br><span class="line"></span><br><span class="line">	mov dx,0</span><br><span class="line">	div cx ;; 不存在余数，因为FFF0</span><br><span class="line">	push ax ;; 把FFF0/CX商保存</span><br><span class="line"></span><br><span class="line">	mov ax,bx</span><br><span class="line">	mov bx,10H</span><br><span class="line">	mul bx ;; 在除之前要把BX乘10H,得到F0</span><br><span class="line">	mov dx,0</span><br><span class="line">	div cx ;; 不存在余数，因为为F0</span><br><span class="line">	</span><br><span class="line">	mov bx,10H ;; 这为了计算正确，F0/A != F/A</span><br><span class="line">	div bx</span><br><span class="line">	;; 现在 ax中就是 商，dx就是余数</span><br><span class="line">	;; 把把 ax加到之前的(FFF0/CX)商中</span><br><span class="line">	pop bx;; 拿到 FFF0/CX的值</span><br><span class="line">	add ax,bx ;; 现在这里的就是其高位的值</span><br><span class="line">	push ax ;; 保存ax</span><br><span class="line"></span><br><span class="line">	mov ax,dx ;; dx放到 ax中做乘法运算</span><br><span class="line">	mov bx,1000H</span><br><span class="line">	mul bx</span><br><span class="line">	mov dx,ax ;; 把乘法的值还到 dx中</span><br><span class="line">	pop ax ;; 拿加ax</span><br><span class="line"></span><br><span class="line">	;; AX=1999, DX=8000 实际结果是19998000</span><br><span class="line">	ret </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line">end start</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a class="simple-lightbox" target="_blank" rel="noopener" href="https://img2023.cnblogs.com/blog/2146100/202304/2146100-20230401220714901-1380957578.png"><img   src="/images/loading.svg" data-src="https://img2023.cnblogs.com/blog/2146100/202304/2146100-20230401220714901-1380957578.png"  alt="image" lazyload></a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43569916/article/details/104866904">https://blog.csdn.net/weixin_43569916/article/details/104866904</a><br>看了这个后，我麻了。我花了三个小时写的东西，人家一下就写出来了。<br>我主要是没想通，DX没除完，还剩的 一个值，居然可以放到下一个值的前面。照样可以继续算。<br>所以我思路 有 误，我用另一种 思路实现了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">assume cs:code</span><br><span class="line"></span><br><span class="line">code segment</span><br><span class="line"></span><br><span class="line">start:</span><br><span class="line">	mov ax,424CH</span><br><span class="line">	mov dx,0FFFFH</span><br><span class="line">	mov cx,0AH</span><br><span class="line"></span><br><span class="line">	call divdw</span><br><span class="line"></span><br><span class="line">	mov ax,4c00h</span><br><span class="line">	int 21h</span><br><span class="line"></span><br><span class="line">divdw:</span><br><span class="line">	;; 先做高位除法</span><br><span class="line">	push ax</span><br><span class="line">	mov ax,dx</span><br><span class="line">	mov dx,0</span><br><span class="line">	div cx</span><br><span class="line">	mov bx,ax</span><br><span class="line">	;; 计算低位</span><br><span class="line">	pop ax</span><br><span class="line">	div cx</span><br><span class="line">	mov cx,dx ;; 先移余数</span><br><span class="line">	mov dx,bx ;; bx是高位的商</span><br><span class="line">	ret</span><br><span class="line"></span><br><span class="line">code ends</span><br><span class="line"></span><br><span class="line">end start</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><a class="simple-lightbox" target="_blank" rel="noopener" href="https://img2023.cnblogs.com/blog/2146100/202304/2146100-20230401223648984-1880329058.png"><img   src="/images/loading.svg" data-src="https://img2023.cnblogs.com/blog/2146100/202304/2146100-20230401223648984-1880329058.png"  alt="image" lazyload></a></p>

        </div>
          
        <div class="top-div">
          <ol class="top-box"><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E6%98%BE%E7%A4%BA%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="top-box-text">显示字符串</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E8%A7%A3%E5%86%B3%E9%99%A4%E6%B3%95%E6%BA%A2%E5%87%BA"><span class="top-box-text">解决除法溢出</span></a></li></ol>
        </div>
          
      </div>
    </div>

    
      <div class="next-post">
        <a class="purple-link" href="/2023/04/01/hui-bian-ji-suan-ci-fang-mo-kuai-hua-she-ji/">
          <h3 class="post-title">
            下一篇：8086汇编计算次方，模块化设计
          </h3>
        </a>
      </div>
    
  </div>










<footer>
<div class="site-footer">
  <div class="social-container">
    
      
        <a aria-label="跳转至github" href="https://github.com/f-dong" target="_blank">
          <i class="icon icon-github"></i>
        </a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  </div>
  
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> <a href="https://github.com/f-dong/hexo-theme-minimalism" target="_blank">Theme</a>
  
  
  
  
  
  
</div>
</footer>


      </div>
    </div>
    
<script id="hexo-configurations"> window.theme_config = {"image":{"lazyload_enable":true,"photo_zoom":"simple-lightbox"}}; window.is_post = true; </script>

<script src="/js/main.js"></script>






  <script src="/js/simple-lightbox.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {new SimpleLightbox('.post-detail .simple-lightbox', {fileExt: false,captionsData:'alt'});});</script></body>
</html>

